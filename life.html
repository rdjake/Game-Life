<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Игра Жизнь</title>
    <script src="life.js" defer></script>
    <link rel="stylesheet" href="life.css" />
    <link rel="icon" href="icon.png" />
  </head>
  <body class="body">
    <div class="menu">
      <div class="menu__main">
        <div class="menu__title">
          <img src="icon.png" width="100" height="100" />
          <h1>Жизнь</h1>
        </div>
        <div class="menu__row">
          <p class="gray-container">
            Поколение: <span id="generation">0</span>
          </p>
          <p class="gray-container">
            Число живых клеток: <span id="alive">0</span>
          </p>
        </div>
        <div class="menu__row">
          <div class="gray-container">
            <p>Расчёт поколения</p>
            <p id="genTime">0 мс</p>
          </div>
          <div class="gray-container">
            <p>Суммарное время</p>
            <p id="sumTime">0 мс</p>
          </div>
        </div>
        <h3>Управление</h3>
        <div class="gray-container">
          <span>Размерность поля</span>
          <input id="size" type="number" value="50" class="input" />
          <button id="apply" class="btn__apply">Применить</button>
          <div class="button-container">
            <button id="start" class="btn__start">Старт</button>
            <button id="stop" disabled class="btn__stop">Стоп</button>
            <button id="clear" disabled class="btn__clear">Очистить</button>
          </div>
        </div>
      </div>
      <div class="menu__notes">
        <h3 class="menu__notes-caption">Описание игры</h3>
        <div class="menu__notes-content">
          <h4>Мониторинг выполения</h4>
          <div class="lightgray-container">
            Краткое текущее состоние игры отображается в виде блоков.
            <ul>
              <li>
                Блок "Поколение" отображает сколько поколений прошла заданная
                популяция клеток.
              </li>
              <li>
                Блок "Число живых клеток" отображает количество живых клеток на
                игровом поле.
              </li>
              <li>
                Блок "Расчёт поколения" отображает время расчёта текущего
                поколения в миллисекундах.
              </li>
              <li>
                Блок "Суммарное время" отображает суммарное время расчёта всех
                поколений в миллисекундах.
              </li>
            </ul>
            Время расчёта поколения складывается из:
            <ul>
              <li>Создание вспомогальных данных для расчётов.</li>
              <li>Вычисление списка живых клеток нового поколения.</li>
              <li>Проверка признаков прекращения игры.</li>
              <li>Отрисовка нового поколения на игровом поле.</li>
            </ul>
          </div>
          <h4>Управление</h4>
          <div class="lightgray-container">
            Изменение игрового состояния осуществляется в блоке "Управление".
            <ul>
              <li>
                Размерность квадратного игрового поля задается вводом нужного,
                кратного 5, значения в текстовое поле (по умолчанию 50).
              </li>
              <li>
                Кнопка "Применить" перерисовывает игровое поле до нужной
                размерности (активна во время паузы игры). В целях экономии
                места с увеличением размерности поля уменьшается размер клеток
                вплоть до 4 пикселей, далее само поле будет увеличиваться в
                размерах.
              </li>
              <li>
                Кнопка "Старт" запускает/продолжает расчёт следующего поколения
                (активна во время паузы игры).
              </li>
              <li>
                Кнопка "Стоп" останавливает расчёты и переводит игру в режим
                паузы (активна в режиме выполения).
              </li>
              <li>
                Кнопка "Очистить" очищает игровое поле от живых клеток и
                сбрасывает значения счётчиков "Поколение", "Расчёт поколения" и
                "Суммарное время".
              </li>
            </ul>
          </div>
          <h4>Игровой процесс</h4>
          <div class="lightgray-container">
            <ul>
              <li>
                Добавление новой живой клетки осуществляется путем нажатия мышью
                на нужную клетку игрового поля. Добавление работает до старта
                расчётов, на паузе и во время выполения расчётов.
              </li>
              <li>
                Менять размерность игрового поля можно до старта расчётов и на
                паузе. Для удобства проведения тестов на больших размерностях,
                можно отметить живые клетки на маленькой размерности, а затем
                задать большую размерность (отмеченные клетки сохранятся).
              </li>
              <li>
                Пока игра не запущена/на паузе живые клетки, которые остаются за
                пределами игрового поля после уменьшения размерности остаются в
                памяти, поэтому при задании большей размерности их можно снова
                увидеть. Как только игра запускается/снимается с паузы игровое
                поле обрезается в соотвествии с текущей размерностью и клетки
                оставшиеся за пределами поля удаляются.
              </li>
              <li>
                Игра ставится на паузу, если не осталось живых клеток или в
                следующем поколении ни одна из клеток не поменяла своего
                состояния.
              </li>
            </ul>
          </div>
          <h4>Оптимизация</h4>
          <div class="lightgray-container">
            Производительность игры не зависит от выбранной размерности, а
            зависит от количества живых клеток.
            <ul>
              <li>
                В памяти хранятся данные только живых клеток и только тех,
                которые остались в пределах игрового поля на момент запуска
                расчётов.
              </li>
              <li>
                Отрисовка сетки игрового поля происходит один раз до начала
                расчётов. Во время расчётов перерисовываются только живые
                клетки.
              </li>
              <li>
                Во время расчёта нового поколения на "умирание" проверяются
                только живые клетки, а на "оживание" только их соседи.
              </li>
              <li>
                Цикл подсчёта живых соседей может быть завершен заранее, если их
                количество становится больше 3.
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div id="canvas-container">
      <canvas id="canvas-grid"></canvas>
      <canvas id="canvas-cells"></canvas>
    </div>
  </body>
</html>
